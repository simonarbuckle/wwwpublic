/*
 * Copyright 2013 Plugin developer. 
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:atplugins/carousel/Carousel.js
//*******************
Aria.classDefinition({$classpath:"atplugins.carousel.Carousel",$extends:"aria.widgetLibs.BaseWidget",$dependencies:["atplugins.carousel.CarouselCfgBeans","aria.utils.Event","aria.utils.Json"],$css:["atplugins.carousel.CarouselStyle"],$constructor:function(i){aria.core.JsonValidator.normalize({json:i,beanName:"atplugins.carousel.CarouselCfgBeans.CarouselCfg"}),atplugins.carousel.Carousel.TRANSITIONCSS=i.transitionCSS,this._ulId=this._createDynamicId(),this._captionId=this._createDynamicId(),this._ul=null,this.__timer=null,this._images=i.images.map(function(i){return"object"==typeof i?i.src:i},this),this._captions=i.images.map(function(i){return"object"==typeof i?i.title:""},this),this._total=i.images.length,this.__jsonBindings=[],this.__eventBindings=[];var t,s=parseInt(i.index,10)||0;if(i.bind){if(this.__indexChangedHandler={fn:this.__indexChanged,scope:this},this.__loopChangedHandler={fn:this.__loopChanged,scope:this},t=i.bind.index){var n=parseInt(t.inside[t.to],10);isNaN(n)?aria.utils.Json.setValue(t.inside,t.to,s):s=n,this.__jsonBindings.push([t.inside,t.to,this.__indexChangedHandler])}t=i.bind.loop,t&&(this.__jsonBindings.push([t.inside,t.to,this.__loopChangedHandler,!1,!0]),aria.utils.Json.inject(t.inside[t.to],i.loop))}this._idx=s>=0&&s<this._total?s+1:1,this.$BaseWidget.constructor.apply(this,arguments)},$destructor:function(){var i,t,s=this.__jsonBindings;for(i=0,t=this.__eventBindings.length;t>i;i++)aria.utils.Event.removeListener.apply(aria.utils.Event,this.__eventBindings[i]);for(i=0,t=s.length;t>i;i++)aria.utils.Json.removeListener(s[0],s[1],s[2],!!s[4]);this.$BaseWidget.$destructor.call(this)},$prototype:{writeMarkup:function(i){var t=this._cfg,s=this._images,n=this._captions[this._idx-1];this.__captionDisplayed=n.length>0,i.write([].concat(['<div class="carouselPlugin ',t.cssClass||"",'" style="width:',t.width,"px;height:",t.height,'px">','<div id="',this._captionId,'" class="caption" style="width:',t.width,"px;height:",t.titleheight,"px;line-height:",t.titleheight,"px;",this.__captionDisplayed?'">':'display:none">',n,"</div>",'<ul id="',this._ulId,'" class="anim" style="left:',-this._idx*t.width,'px">','<li><img src="',s[s.length-1],'" /></li>'],s.map(function(i){return'<li><img src="'+i+'" /></li>'},this),['<li><img src="',s[0],'" /></li>',"</ul></div>"]).join(""))},initWidget:function(){this._ul=document.getElementById(this._ulId),this._caption=document.getElementById(this._captionId);var i=this._cfg.controls;if(i){var t;this.__previousHandler={fn:this._previous,scope:this},this.__nextHandler={fn:this._next,scope:this},i.previous&&(t=document.getElementById(i.previous))&&this.__eventBindings.push([t,"click",this.__previousHandler]),i.next&&(t=document.getElementById(i.next))&&this.__eventBindings.push([t,"click",this.__nextHandler])}this.__initBindings(),this.__setLoop()},__initBindings:function(){var i,t;for(i=0,t=this.__eventBindings.length;t>i;i++)aria.utils.Event.addListener.apply(aria.utils.Event,this.__eventBindings[i]);for(i=0,t=this.__jsonBindings.length;t>i;i++)aria.utils.Json.addListener.apply(aria.utils.Json,this.__jsonBindings[i])},_next:function(){this._shift(this._total+1-this._idx,1,1)},_previous:function(){this._shift(this._idx,this._total,-1)},_shift:function(i,t,s){if(2>i){if("stop"==this._cfg.loop.type)return;if("reverse"==this._cfg.loop.type)return aria.utils.Json.setValue(this._cfg.loop,"direction",!this._cfg.loop.direction),void 0;"rewind"==this._cfg.loop.type&&(s=t-this._idx)}0===i&&"continuous"==this._cfg.loop.type&&this.__swap(t),this._idx+=s,this.__putImgAndCaption();var n;if(this._cfg.bind&&(n=this._cfg.bind.index)){var e=this._idx<1?this._total-1:this._idx>this._total?0:this._idx-1;aria.utils.Json.setValue(n.inside,n.to,e,this.__indexChangedHandler)}},__swap:function(i){this._ul.className="",this._idx=i,this._ul.style.left=-this._idx*this._cfg.width+"px",this._ul.offsetWidth,this._ul.className="anim"},__indexChanged:function(){var i=parseInt(this._cfg.bind.index.inside[this._cfg.bind.index.to],10);0>i||i>this._total-1||i+1==this._idx||(clearInterval(this.__timer),this._idx==this._total+1&&0!==i&&this.__swap(1),0===this._idx&&i!=this._total-1&&this.__swap(this._total),this._idx=i+1,this.__putImgAndCaption(),this.__setLoop())},__putImgAndCaption:function(){this._ul.style.left=-this._idx*this._cfg.width+"px";var i=this._idx<1?this._total-1:this._idx>this._total?0:this._idx-1;this._captions[i].length>0?(this._caption.innerHTML=this._captions[i],this.__captionDisplayed||(this._caption.style.display="block",this.__captionDisplayed=!0)):this.__captionDisplayed&&(this._caption.style.display="none",this.__captionDisplayed=!1)},__setLoop:function(){var i=this._cfg.loop;if(i.speed>0){var t=this;this.__timer=setInterval(function(){i.direction?t._next():t._previous()},1e3*i.speed)}},__loopChanged:function(i){clearInterval(this.__timer),"type"==i.dataName&&"continuous"==i.oldValue&&(0===this._idx?this.__swap(this._total):this._idx==this._total+1&&this.__swap(1)),this._cfg.loop[i.dataName]=i.newValue,this.__setLoop()}}});
//*******************
//LOGICAL-PATH:atplugins/carousel/CarouselCfgBeans.js
//*******************
Aria.beanDefinitions({$package:"atplugins.carousel.CarouselCfgBeans",$namespaces:{json:"aria.core.JsonTypes"},$beans:{BindingRef:{$type:"json:Object",$properties:{to:{$type:"json:JsonProperty"},inside:{$type:"json:ObjectRef"}}},ImageDef:{$type:"json:Object",$properties:{src:{$type:"json:String",$sample:"static/img/mypic.jpg"},title:{$type:"json:String",$sample:"Description of the image"}}},CarouselCfg:{$type:"json:Object",$properties:{width:{$type:"json:Integer",$mandatory:!0},height:{$type:"json:Integer",$mandatory:!0},titleheight:{$type:"json:Integer",$default:30},images:{$type:"json:Array",$mandatory:!0,$contentType:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String",$sample:"static/img/mypic.jpg"},{$type:"ImageDef"}]}},loop:{$type:"json:Object",$default:{type:"continuous",direction:!0,speed:0},$properties:{type:{$type:"json:Enum",$enumValues:["stop","continuous","rewind","reverse"],$default:"continuous"},direction:{$type:"json:Boolean",$default:!0},speed:{$type:"json:Integer",$default:0}}},index:{$type:"json:Integer",$default:0},cssClass:{$type:"json:String"},transitionCSS:{$type:"json:String",$default:"0.5s ease-out",$sample:"1s ease-in-out"},bind:{$type:"json:Object",$properties:{loop:{$type:"BindingRef"},index:{$type:"BindingRef"}}}}}}});
//*******************
//LOGICAL-PATH:atplugins/carousel/CarouselLib.js
//*******************
Aria.classDefinition({$classpath:"atplugins.carousel.CarouselLib",$extends:"aria.widgetLibs.WidgetLib",$singleton:!0,$prototype:{widgets:{Carousel:"atplugins.carousel.Carousel"}}});
//*******************
//LOGICAL-PATH:atplugins/carousel/CarouselStyle.tpl.css
//*******************
Aria.classDefinition({$classpath:"atplugins.carousel.CarouselStyle",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this){var transition="left "+atplugins.carousel.Carousel.TRANSITIONCSS;this.__$write("\n\ndiv.carouselPlugin {\noverflow: hidden;\nposition: relative;\n}\n\ndiv.carouselPlugin ul {\nlist-style: none;\nmargin: 0;\npadding: 0;\nposition: relative;\nwidth: 9999px;\n}\n\ndiv.caption {\nbackground-color: rgba(0, 0, 0, 0.6);\nbottom: 0;\ncolor: white;\nfont-size: 12pt;\nfont-weight: bold;\nposition: absolute;\ntext-align: center;\nz-index: 9999;\n}\n\ndiv.carouselPlugin ul.anim {\ntransition: ",23),this.__$write(transition,49),this.__$write(";\n-moz-transition: ",49),this.__$write(transition,50),this.__$write(";\n-webkit-transition: ",50),this.__$write(transition,51),this.__$write(";\n-o-transition: ",51),this.__$write(transition,52),this.__$write(";\n}\n\ndiv.carouselPlugin li {\ndisplay:inline;\n}\n\n",52)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},$init:function(t){t.__$csslibs={},t.__$prefix=!0},__$initTemplate:function(){return!0}}});