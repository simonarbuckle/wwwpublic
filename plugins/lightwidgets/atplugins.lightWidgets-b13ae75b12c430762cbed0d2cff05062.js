/*
 * Copyright 2013 Plugin developer. 
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/DropDown.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"DropDown",$dependencies:["aria.utils.Dom","aria.utils.Json","aria.popups.Popup","aria.html.Template","aria.templates.Layout"],$constructor:function(t){this._cfg=t,this._popup=null,this._offset={top:1,bottom:0,left:0,right:0},this._inhibitAfterClose=!1,aria.templates.Layout.$on({viewportResized:this._onViewportResized,scope:this})},$destructor:function(){aria.templates.Layout.$unregisterListeners(this),this.close()},$prototype:{open:function(){var t=this._cfg,e=t.context.createSection({fn:this._contentWriter,scope:this});this._popup=new aria.popups.Popup,this._connectPopupEvents(),this._popup.open({section:e,domReference:t.domReference,keepSection:!1,preferredPositions:[{reference:"bottom left",popup:"top left"},{reference:"top left",popup:"bottom left"}],offset:this._offset,center:!1,closeOnMouseClick:!0,closeOnMouseScroll:!1,ignoreClicksOn:t.ignoreClicksOn})},close:function(){this._popup&&this._popup.isOpen&&this._popup.close()},isOpen:function(){return this._popup?this._popup.isOpen:!1},_onViewportResized:function(){this.isOpen()&&(this._inhibitAfterClose=!0,this.close(),this._inhibitAfterClose=!1,this.open())},_contentWriter:Aria.empty,_connectPopupEvents:function(){this._popup.$addListeners({"*":{fn:this._onPopupEvent},scope:this})},_disconnectPopupEvents:function(){this._popup.$unregisterListeners(this)},_onPopupEvent:function(t){var e=this._cfg;this["_"+t.name]&&this["_"+t.name](),e[t.name]&&!this._inhibitAfterClose&&this.$callback(e[t.name],t)},_onAfterClose:function(){this._disconnectPopupEvents(),this._popup.$dispose()}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/DropDownCfgBeans.js
//*******************
(function(){var e="atplugins.lightWidgets",t=e+".";Aria.nspace(e,!0),Aria.beanDefinitions({$package:t+"DropDownCfgBeans",$namespaces:{json:"aria.core.JsonTypes"},$beans:{Configuration:{$type:"json:Object",$restricted:!1,$properties:{context:{$type:"json:ObjectRef",$mandatory:!0},lineNumber:{$type:"json:Integer"},domReference:{$type:"json:Object",$mandatory:!0},ignoreClicksOn:{$type:"json:Array",$contentType:{$type:"json:ObjectRef"},$default:[{}]}}}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/LazyLoader.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"LazyLoader",$singleton:!0,$dependencies:["aria.utils.Json"],$statics:{LOADING:1,LOADED:2},$prototype:{_depMap:{},_status:{},_callbacks:{},register:function(t,e){this._depMap[t]=e,this._callbacks[t]=[]},load:function(t,e){var s=this._depMap[t];if(s){var i=this._status[t];if(i==this.LOADING)return this._callbacks[t].push(e),void 0;if(i==this.LOADED)return this.$callback(e),void 0;var n=aria.utils.Json.copy(s);this._callbacks[t].push(e),n.oncomplete={fn:this._executeCallbacks,scope:this,args:t,resIndex:-1},Aria.load(n)}},isLoaded:function(t){return this._status[t]==this.LOADED||!1},_executeCallbacks:function(t){this._status[t]=this.LOADED;for(var e=this._callbacks[t],s=0,i=e.length;i>s;s++)this.$callback(e[s]);this._callbacks[t]=[]}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/LightWidgetLib.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"LightWidgetLib",$extends:"aria.widgetLibs.WidgetLib",$singleton:!0,$prototype:{widgets:{TextInput:e+"textinput.TextInputWithOnChange",DatePicker:e+"datepicker.DatePicker",DateField:e+"datefield.DateField",Autocomplete:e+"autocomplete.Autocomplete",Calendar:e+"calendar.Calendar"}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/autocomplete/Autocomplete.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".",s=Aria.nspace(t,!0);Aria.classDefinition({$classpath:e+"autocomplete.Autocomplete",$extends:e+"textinput.TextInputWithOnChange",$dependencies:["aria.utils.Dom","aria.utils.Event","aria.html.controllers.Suggestions",e+"LazyLoader",e+"autocomplete.AutocompleteCfgBeans","aria.utils.Json"],$constructor:function(t,i,n){t.on||(t.on={}),this._suggestionsOff=!1,this._caretDifferent=!1,this._jsonUtils=aria.utils.Json,this.$cfgBean=e+"autocomplete.AutocompleteCfgBeans.Properties",t.attributes=t.attributes||{},t.attributes.classList=t.attributes.classList?t.attributes.classList.concat(t.sclass):[t.sclass],t.attributes.autocomplete="off",this.$TextInputWithOnChange.constructor.call(this,t,i,n),this._keyCode=null,this._buffer="",this._dropdown=null,this.data={};var o=this.data;o.preselect="always"==t.preselect?0:-1,this._resetIdxs(),o.selectedIdx=null;var a=Aria.getClassInstance("aria.html.controllers.Suggestions");a.setResourcesHandler(t.resourcesHandler),this._highlightedIdxListener={fn:this._onHighlightChange,scope:this},this._selectedIdxListener={fn:this._onSelectionChange,scope:this},this._suggestionListener={fn:this._onSuggestionsChange,scope:this};var r=this._jsonUtils;r.addListener(o,"highlightedIdx",this._highlightedIdxListener),r.addListener(o,"selectedIdx",this._selectedIdxListener),r.addListener(a.data,"suggestions",this._suggestionListener),this.suggestionController=a,t.suggestionsTemplate=t.suggestionsTemplate||a._resourcesHandler.getDefaultTemplate(),s.LazyLoader.register(this.$classpath,{classes:[e+"autocomplete.AutocompleteDropDown"],templates:[t.suggestionsTemplate]})},$destructor:function(){var t=this._jsonUtils,e=this.data;this._dropdown&&(this._dropdown.isOpen()?this._dropdown.close():this._onDropDownClose()),t.removeListener(e,"highlightedIdx",this._highlightedIdxListener),t.removeListener(e,"selectedIdx",this._selectedIdxListener),t.removeListener(this.suggestionController.data,"suggestions",this._suggestionListener),this.suggestionController.$dispose(),this.$TextInputWithOnChange.$destructor.call(this)},$prototype:{initWidget:function(){this.$TextInputWithOnChange.initWidget.call(this),this._cfg.lazy||s.LazyLoader.load(this.$classpath)},_transform:function(t,e,s){var i=null;return"fromWidget"==s?(i=this._interpret(e),i&&this.onbind("value",i,e),this.$TextInputWithOnChange._transform.call(this,t,i,s)):e?(null!=e&&"object"==typeof e&&(e=null!=e?this._getLabelFromSuggestion(e):""),i=this.$TextInputWithOnChange._transform.call(this,t,e,s),e):""},_interpret:function(t){var e,s,i=null,n=this.data.selectedIdx,o=this.data.highlightedIdx,a=this.suggestionController.data.suggestions,r=this._bindingListeners;return r&&r.value&&(e=r.value,s=e.inside[e.to]),i=this._keyCode==aria.DomEvent.KC_ESCAPE?this._buffer:(n||0===n)&&n>=0?a[n]:a&&a.length>0&&o>=0?a[o]:s&&"object"==typeof s&&this._getLabelFromSuggestion(s)==t?s:t},onbind:function(t,e,s){null!=e&&"object"==typeof e&&(e=null!=e?this._getLabelFromSuggestion(e):""),this.$TextInputWithOnChange.onbind.call(this,t,e,s)},_onHighlightChange:function(t){var e=t.newValue;if(e>=0){var s=this.data.items[e].label;this._domElt.value=s}},_onSelectionChange:function(t){this._suggestionsOff=!0;var e=t.newValue;if(e>=0){var s=this.data.items[e].label;this._domElt.value=s}},_onkeydown:function(t){this._keyCode=t.keyCode;var e=this._keyCode,s=aria.DomEvent,i=this._jsonUtils,n=this.data,o=this._dropdown&&this._dropdown.isOpen();if(e!=s.KC_UP&&(e!=s.KC_DOWN||!o)&&e!=s.KC_ESCAPE){this._buffer=this._domElt.value,this._suggestionsOff=!1;var a=aria.utils.Caret.getPosition(this._domElt);this._caretDifferent=a.start!=a.end}if(e==s.KC_DOWN)if(t.preventDefault(),o){this._suggestionsOff=!0;var r=n.highlightedIdx,l=n.items.length-1;null!=r&&r>=0&&l>r?(n.oldHighlightedIdx=r,i.setValue(n,"highlightedIdx",r+1)):-1==r&&(n.oldHighlightedIdx=0,i.setValue(n,"highlightedIdx",0))}else this.data.textValue=this._buffer,this.suggestionController.suggestValue(this._buffer);else if(e==s.KC_UP){if(t.preventDefault(),o){this._suggestionsOff=!0;var r=n.highlightedIdx;r>0&&(n.oldHighlightedIdx=r,i.setValue(n,"highlightedIdx",r-1))}}else e==s.KC_ENTER||e==s.KC_TAB?o?(n.highlightedIdx>=0&&i.setValue(n,"selectedIdx",n.highlightedIdx),this._reportValueToDataModel(),this._dropdown.close(),e==s.KC_ENTER&&t.preventDefault()):e==s.KC_ENTER&&this._reportValueToDataModel():e==s.KC_ESCAPE&&o&&(this._dropdown.close(),i.setValue(n,"selectedIdx",-1),i.setValue(n,"highlightedIdx",-1),this._reportValueToDataModel());return!0},_reportValueToDataModel:function(){var t,e=this._bindingListeners,s=this._transform(void 0,this._domElt.value,"fromWidget");e&&e.value&&(t=e.value,this._jsonUtils.setValue(t.inside,t.to,s,t.cb))},_ontype:function(){var t=this._domElt.value,e=aria.DomEvent,s=aria.core.Browser;(!this._suggestionsOff&&this._keyCode!=e.KC_ESCAPE&&this._keyCode!=e.KC_TAB&&(t!=this._buffer||this._caretDifferent)||s.isAndroid&&s.isChrome)&&(this.data.textValue=t,this.suggestionController.suggestValue(t),this._buffer=t)},_onCutOrPaste:function(t){0===t.keyCode&&(this._onkeydown({keyCode:0}),aria.core.Timer.addCallback({fn:this._ontype,scope:this,delay:10}))},_onSuggestionsChange:function(){if(s.LazyLoader.isLoaded(this.$classpath)){var t=this.suggestionController.data.suggestions;this._dropdown||(this._dropdown=new s.autocomplete.AutocompleteDropDown(this._getDropDownConfig()));var e=this._dropdown;t&&0!==t.length?e.isOpen()?e.refresh():(this._resetIdxs(),e.open()):e.isOpen()&&e.close()}else s.LazyLoader.load(this.$classpath,{fn:this._onSuggestionsChange,scope:this})},_getDropDownConfig:function(){return{data:this.data,context:this._context,controller:this.suggestionController,template:this._cfg.suggestionsTemplate,domReference:this._domElt,lineNumber:this._lineNumber,onAfterClose:{fn:this._onDropDownClose,scope:this},sclass:this._cfg.sclass||"std"}},_registerListeners:function(t){this.$TextInputWithOnChange._registerListeners.call(this,t);for(var e=t.on,s=["keydown","paste","cut","type"],i=["_onkeydown","_onCutOrPaste","_onCutOrPaste","_ontype"],n=0,o=s.length;o>n;n++){var a=s[n];this._chainListener(e,a,{fn:this[i[n]],scope:this})}},_getLabelFromSuggestion:function(t){return this.suggestionController._resourcesHandler.suggestionToLabel(t)},_onDropDownClose:function(){this._dropdown.$dispose(),this._dropdown=null},_resetIdxs:function(){var t=this.data;t.selectedIdx=null,delete t.oldHighlightedIdx,0===t.preselect?t.highlightedIdx=0:-1==t.preselect&&(t.highlightedIdx=-1)}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/autocomplete/AutocompleteCfgBeans.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.beanDefinitions({$package:e+"autocomplete.AutocompleteCfgBeans",$namespaces:{json:"aria.core.JsonTypes",base:"aria.html.beans.TextInputCfg"},$beans:{Properties:{$type:"base:Properties",$properties:{preselect:{$type:"json:Enum",$enumValues:["strict","always","none"],$default:"strict"},suggestionsTemplate:{$type:"json:PackageName"},lazy:{$type:"json:Boolean",$default:!1},resourcesHandler:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:PackageName"},{$type:"json:ObjectRef"}],$mandatory:!0},sclass:{$type:"json:String",$default:"std"}}}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/autocomplete/AutocompleteDropDown.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"autocomplete.AutocompleteDropDown",$extends:e+"DropDown",$dependencies:["aria.utils.Dom","aria.utils.Json","aria.popups.Popup","aria.html.Template"],$constructor:function(t){this.$DropDown.constructor.call(this,t),this.data=t.data,this._popupStatusListener={fn:this._onpopupStatusChange,scope:this},aria.utils.Json.addListener(this.data,"popupOpen",this._popupStatusListener),this._templateInstance=null,this._sclass=t.sclass},$destructor:function(){aria.utils.Json.removeListener(this.data,"popupOpen",this._popupStatusListener),this.data=null,this._popupStatusListener=null,this.$DropDown.$destructor.call(this)},$prototype:{_onpopupStatusChange:function(t){t.newValue||this.close()},open:function(){this.$DropDown.open.call(this),aria.utils.Json.setValue(this.data,"popupOpen",!0)},_onAfterClose:function(){aria.utils.Json.setValue(this.data,"popupOpen",!1,this._popupStatusListener),this.$DropDown._onAfterClose.call(this)},_contentWriter:function(t){this._prepareDataForTemplate();var e={classpath:this._cfg.template,data:this.data,attributes:{style:"display: inline-block; height: 10px; overflow: visible",classList:[this._sclass+"acListContainer"]}},s=new aria.html.Template(e,this._cfg.context,this._cfg.lineNumber);t.registerBehavior(s),s.writeMarkup(t),this._templateInstance=s},refresh:function(){this._prepareDataForTemplate(),this._templateInstance.subTplCtxt.$refresh()},_prepareDataForTemplate:function(){var t=this._cfg,e=t.controller.data,s=this._prepareSuggestionsAndMatch(e.suggestions,this.data.textValue),i=this._mergeItemsAndSelectionInfo(e.newsuggestions,e.suggestions,s),n={};n.cssClassItem="xACItem",n.cssClassEnabled="xACEnabledItem",n.cssClassSelected="xACSelectedItem",n.cssClassDisabled="xACDisabledItem",n.cssClassMouseover="xACMouseOverItem",n.cssClassFooter="xACFooter",this.data.items=i.items,this.data.skin=n,this.data.selectedIdx=null},_prepareSuggestionsAndMatch:function(t,e){var s,i=-1;this._cfg.controller.data.newsuggestions=[];for(var n,o=0,a=t.length;a>o;o+=1){s=t[o],-1==i&&s.exactMatch&&(i=o),n=this._getLabelFromSuggestion(s);var r={entry:e,label:n,value:s};this._cfg.controller.data.newsuggestions[o]=r}return i},_getLabelFromSuggestion:function(t){return this._cfg.controller._resourcesHandler.suggestionToLabel(t)},_mergeItemsAndSelectionInfo:function(t,e,s){var i,n=aria.utils.Array;s=void 0===i?s:i;var o=this._getTrueMaxSelectedCount(t),a=!0,r=t,l="label",h="value",u="disabled";aria.utils.Type.isArray(t)||(r=t.container,l=t.labelProperty,h=t.valueProperty,u=t.disabledProperty);for(var p=[],c=-1,d=0,g=0,_=r.length;_>g;g++){var f=r[g],m=e?n.contains(e,f[h])||s===g:!1;t[g].disabled&&(m=!1),m&&(o>d?(d++,null!=c&&(c=-1==c?g:null)):(a=!0,m=!1));var C=u?f[u]:!1;p[g]={index:g,label:f[l],value:f[h],object:f,selected:m,initiallyDisabled:C,currentlyDisabled:C}}if(d==o)for(var g=0,_=p.length;_>g;g++)p[g].selected||(p[g].currentlyDisabled=!0);return{items:p,pbMaxSelected:a,selectedIndex:c,selectedCount:d}},_getTrueMaxSelectedCount:function(t){var e=this._cfg.controller.data,s=e.multipleSelect?e.maxSelectedCount:1;return null==s&&(null==t&&(t=e.items),s=1+t.length),this.$assert(268,s>=1),s}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/autocomplete/AutocompleteTemplate.tpl
//*******************
Aria.classDefinition({$classpath:"atplugins.lightWidgets.autocomplete.AutocompleteTemplate",$extends:"aria.templates.Template",$constructor:function(){this.$Template.constructor.call(this),this.$AutocompleteTemplateScript.constructor.call(this)},$destructor:function(){this.$AutocompleteTemplateScript.$destructor.call(this),this.$Template.$destructor.call(this)},$dependencies:["aria.widgets.AriaLib","atplugins.lightWidgets.autocomplete.AutocompleteTemplateScript"],$prototype:{macro_main:function(){try{with(this)this.__$write('\n<div class="autocomplete_container" id="autocomplete_container">\n',23),this.__$beginSection(24,!1,{id:"Items",macro:"renderItemsList"}),this.__$endSection(),this.__$write("\n</div>\n",28)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},macro_renderItemsList:function(){try{with(this){var items=[data.items];this.__$write("\n<table\n",33),this.__$statementOnEvent("mouseup",this.$normCallback({fn:"itemClick"}),34),this.__$statementOnEvent("mouseover",this.$normCallback({fn:"itemMouseOver"}),35),this.__$write('\ncellpadding="0" cellspacing="0"\n>\n<tbody ',36),this.__$writeId("suggestionsRows",38),this.__$write(" >\n",38),itemIndex=0;for(var key in items)this.macro_renderGroup(key,items[key]);this.__$write("\n</tbody>\n</table>\n",43)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderItemsList",this["aria:currentLineNumber"]],_ex)}},macro_renderGroup:function(key,items){try{with(this)for(var x=0,l=items.length;l>x;x++){var key=0===x&&key,item=items[x];this.macro_renderItem(item,key)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderGroup",this["aria:currentLineNumber"]],_ex)}},macro_renderItem:function(item,key){try{with(this)this.__$write("\n<tr ",56),this.__$writeId("itemIdx"+itemIndex,56),this.__$write(' class="',56),this.__$write(_getClassForItem(itemIndex),56),this.__$write('" >\n<td>\n<div class="item" data-itemIdx="',56),this.__$write(itemIndex,58),this.__$write('">',58),this.__$write(item.label,58),this.__$write("</div>\n</td>\n</tr>\n",58),itemIndex+=1}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderItem",this["aria:currentLineNumber"]],_ex)}},$init:function(t){t.__$macrolibs={},t.__$width={},t.__$height={},aria.core.TplClassLoader._importScriptPrototype(atplugins.lightWidgets.autocomplete.AutocompleteTemplateScript,t)},__$initTemplate:function(){try{with(this)this.itemIndex=0}catch(_ex){return this.$logError(this.EXCEPTION_IN_VARINIT,[this.$classpath],_ex),!1}return!0}}});
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/autocomplete/AutocompleteTemplateScript.js
//*******************
Aria.tplScriptDefinition({$classpath:"atplugins.lightWidgets.autocomplete.AutocompleteTemplateScript",$constructor:function(){this._refContainer="suggestionsRows",this._itemShift=0,this.onKbNav={fn:this._onKeyboardNavigation,scope:this}},$destructor:function(){this.$json.removeListener(this.data,"highlightedIdx",this.onKbNav)},$prototype:{$dataReady:function(){void 0!==this.data.preselect&&this.data.preselect},$displayReady:function(){this.$json.addListener(this.data,"highlightedIdx",this.onKbNav)},itemClick:function(t){if(t.preventDefault(),t.stopPropagation(),this.data.popupOpen){var e=t.target.getData("itemIdx",!0);e&&(this.$json.setValue(this.data,"selectedIdx",this.data.highlightedIdx),this.$json.setValue(this.data,"popupOpen",!1))}},itemMouseOver:function(t){if(this.data.popupOpen){var e=t.target.getData("itemIdx",!0);if(e){var s=this.data.highlightedIdx,i=parseInt(e,10);this.data.oldHighlightedIdx=s,this.data.highlightedIdx=i,s>=0&&this.$getElementById("itemIdx"+s).classList.setClassName(this._getClassForItem(s)),this.$getElementById("itemIdx"+i).classList.setClassName(this._getClassForItem(i))}}},_getClassForItem:function(t){var e=[this.data.skin.cssClassItem];return t==this.data.highlightedIdx&&e.push(this.data.skin.cssClassSelected),this.data.disabled?e.push(this.data.skin.cssClassDisabled):e.push(this.data.skin.cssClassEnabled),e.join(" ")},_onKeyboardNavigation:function(t){var e=t.newValue;if(t.oldValue!=this.data.oldHighlightedIdx)var s=this.data.oldHighlightedIdx;else var s=t.oldValue;var i=e;this.data.highlightedIdx=i,void 0!==s&&this.$getElementById("itemIdx"+s).classList.setClassName(this._getClassForItem(s)),this.$getElementById("itemIdx"+i).classList.setClassName(this._getClassForItem(i)),this.$json.setValue(this.data,"highlightedIdx",i)}}});
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/calendar/Calendar.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".",s=Aria.nspace(t,!0);Aria.classDefinition({$classpath:e+"calendar.Calendar",$extends:"aria.html.Element",$dependencies:[e+"calendar.CalendarController",e+"calendar.CalendarCfgBeans","aria.html.Template","aria.utils.Object","aria.utils.Array"],$constructor:function(t){this.$cfgBean=e+"calendar.CalendarCfgBeans.Properties",this._registerListeners(t),t.attributes=t.attributes||{},t.attributes.tabindex=t.attributes.tabindex||0,this.$Element.constructor.apply(this,arguments);var i=this._cfg.sclass||"std";this._hasFocus=!1;var n=aria.utils.Object.keys(t),a=["on","attributes","id","bind","tagName","sclass"],o=aria.utils.Array;n=o.filter(n,function(t){return!o.contains(a,t)});var r=aria.utils.Json.copy(t,!0,n);r.focus=this._hasFocus,this._data={skin:{sclass:i,baseCSS:"xCalendar_"+i+"_"},settings:r},this._controller=new s.calendar.CalendarController(this._data),this._controllerListener={fn:this._onControllerEvent,scope:this},this._controller.$addListeners({update:this._controllerListener,dateClick:this._controllerListener}),this._templateCfg={classpath:this._cfg.template,data:{dataModel:this._data,controller:this._controller}}},$destructor:function(){this._controller.$removeListeners({update:this._controllerListener,dateClick:this._controllerListener}),this._controllerListener=null,this._controller.$dispose(),this.$Element.$destructor.call(this)},$prototype:{writeMarkup:function(t){this.$Element.writeMarkupBegin.call(this,t);var e=new aria.html.Template(this._templateCfg,this._context,this._lineNumber);t.registerBehavior(e),e.writeMarkup(t),this.$Element.writeMarkupEnd.call(this,t)},writeMarkupBegin:function(){this.$logError(this.INVALID_USAGE,[this.$class,"container"])},writeMarkupEnd:Aria.empty,_transferToDataModel:function(t,e){var s=this._bindingListeners[t];if(s){var i=this._transform(s.transform,e,"fromWidget");aria.utils.Json.setValue(s.inside,s.to,i,s.cb)}},_onControllerEvent:function(t){if(!this._inOnBoundPropertyChange)if("update"==t.name)t.properties.startDate&&this._transferToDataModel("startDate",this._data.settings.startDate),t.properties.value&&(this._transferToDataModel("value",this._data.settings.value),this.evalCallback(this._cfg.onchange));else if("dateClick"==t.name){var e=this._cfg.on.click;if(e)for(var s=0,i=e.length;i>s;s++)this.evalCallback(e[s],t)}},onbind:function(t,e){this._inOnBoundPropertyChange=!0;try{"startDate"==t?this._controller.navigate({},{date:e}):"value"==t&&this._controller.selectDay({date:e})}finally{this._inOnBoundPropertyChange=!1}},_registerListeners:function(t){t.on=t.on||{};for(var e,s=t.on,i=["blur","keydown","focus"],n=0,a=i.length;a>n;n++)e=i[n],this._chainListener(s,e,{fn:this["_dom_on"+e],scope:this})},_dom_onkeydown:function(t){var e=this.getDom();this.sendKey(t.charCode,t.keyCode)&&(t.preventDefault(!0),e.focus())},_dom_onfocus:function(){this._hasFocus=!0},_dom_onblur:function(){this._hasFocus=!1},sendKey:function(t,e){var s=this._controller;return s?s.keyevent({charCode:t,keyCode:e}):!1},getDom:function(){return this._domElt},setWidgetProperty:function(t,e){this._cfg[t]=e}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/calendar/CalendarCfgBeans.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.beanDefinitions({$package:e+"calendar.CalendarCfgBeans",$namespaces:{json:"aria.core.JsonTypes",common:"aria.widgetLibs.CommonBeans",base:"aria.html.beans.ElementCfg"},$beans:{Properties:{$type:"base:Properties",$properties:{bind:{$type:"base:Properties.$properties.bind",$properties:{value:{$type:"common:BindingRef"},startDate:{$type:"common:BindingRef"}}},tagName:{$type:"base:Properties.$properties.tagName",$mandatory:!1,$default:"span"},template:{$type:"json:PackageName",$default:e+"calendar.CalendarTemplate"},label:{$type:"json:String"},showWeekNumbers:{$type:"json:Boolean",$default:!0},value:{$type:"json:Date"},minValue:{$type:"json:Date"},maxValue:{$type:"json:Date"},displayUnit:{$type:"json:Enum",$enumValues:["M","W"],$default:"M"},numberOfUnits:{$type:"json:Integer",$default:3},startDate:{$type:"json:Date"},firstDayOfWeek:{$type:"json:Integer",$minValue:0,$maxValue:6},monthLabelFormat:{$type:"json:String",$default:"MMMM yyyy"},dayOfWeekLabelFormat:{$type:"json:String",$default:"EE"},dateLabelFormat:{$type:"json:String",$default:"d"},completeDateLabelFormat:{$type:"json:String"},showShortcuts:{$type:"json:Boolean",$default:!0},restrainedNavigation:{$type:"json:Boolean",$default:!0},sclass:{$type:"json:String",$default:"std"}}}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/calendar/CalendarController.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"calendar.CalendarController",$dependencies:["aria.utils.Date","aria.utils.environment.Date","aria.utils.Array","aria.utils.Json",e+"calendar.CalendarCfgBeans"],$events:{focusChanged:"",update:"",dateClick:"",keyevent:""},$constructor:function(t){this.json=aria.utils.Json,this._changedSettings={value:{},minValue:{},maxValue:{},startDate:{},displayUnit:{},numberOfUnits:{},firstDayOfWeek:{},monthLabelFormat:{},dayOfWeekLabelFormat:{},dateLabelFormat:{},completeDateLabelFormat:{}},this._changedSettingsNbr=11,this.init(t)},$destructor:function(){this._jsonListener&&(this.json.removeListener(this._calendarSettings,null,this._jsonListener),this._jsonListener=null),this._calendarData=null,this._calendarSettings=null},$prototype:{_settingsProperties:{value:{isDate:!0},minValue:{isDate:!0},maxValue:{isDate:!0},startDate:{isDate:!0},displayUnit:{},numberOfUnits:{},firstDayOfWeek:{},monthLabelFormat:{},dayOfWeekLabelFormat:{},dateLabelFormat:{},completeDateLabelFormat:{}},_defaultKeyActions:{33:{increment:-1,incrementUnit:"M"},34:{increment:1,incrementUnit:"M"},35:{refDate:"maxValue"},36:{refDate:"minValue"},37:{increment:-1,incrementUnit:"D"},38:{increment:-7,incrementUnit:"D"},39:{increment:1,incrementUnit:"D"},40:{increment:7,incrementUnit:"D"}},_jsonDataChanged:function(t){var e=aria.utils.Date,s=t.dataName,a=this._settingsProperties[s];if(a){var i=this._changedSettings[s];null==i&&(i={oldValue:t.oldValue,newValue:t.newValue},this._changedSettingsNbr++),(i.oldValue===t.newValue||a.isDate&&e.isSameDay(i.oldValue,t.newValue))&&(i=null,this._changedSettingsNbr--),this._changedSettings[s]=i}},init:function(t,s){t||(t={}),t.calendar={},t.settings||(t.settings={});var a=t.settings;this._data=t,this._calendarSettings=a,this._calendarData=t.calendar,a.startDate||(a.startDate=new Date),a.completeDateLabelFormat||(a.completeDateLabelFormat=aria.utils.environment.Date.getDateFormats().longFormat),null==a.firstDayOfWeek&&(a.firstDayOfWeek=aria.utils.environment.Date.getFirstDayOfWeek()),aria.core.JsonValidator.normalize({json:this._calendarSettings,beanName:e+"calendar.CalendarCfgBeans.Properties"}),this.update(),this._jsonListener={fn:this._jsonDataChanged,scope:this},this.json.addListener(a,null,this._jsonListener,!0),s&&this.$callback(s)},notifyFocusChanged:function(t){var e={name:"focusChanged",focus:t,cancelDefault:!1};return this.json.setValue(this._data.settings,"focus",t),this.$raiseEvent(e),e.cancelDefault},keyevent:function(t){var e={name:"keyevent",charCode:t.charCode,keyCode:t.keyCode,cancelDefault:!1},s=this._defaultKeyActions[e.keyCode];null!=s&&(e.cancelDefault=!0,this.json.inject(s,e,!1)),this.$raiseEvent(e);var a=this._transformDate(this._calendarSettings.value,e);return a&&this.selectDay({date:a}),e.cancelDefault===!0},getDatePosition:function(t){var e=aria.utils.Array,s=aria.utils.Date,a=this._calendarData,i=s.dayDifference(this._realStartDate,t),n=Math.floor(i/7);if(0>n||n>=a.weeks.length)return null;var r=a.weeks[n],o=i%7,l=r.days[o];this.$assert(228,s.isSameDay(t,l.jsDate));var h=null,c=null,u=a.months[l.monthKey];return null!=u&&(c=e.indexOf(a.months,u),this.$assert(239,u==a.months[c]),h=l.monthKey==r.month||l.monthKey==r.monthEnd?r.indexInMonth:0,this.$assert(245,u.weeks[h]==r)),{weekIndex:n,monthIndex:c,weekInMonthIndex:h,dayInWeekIndex:o,month:u,week:r,day:l}},dateClick:function(t){var e={name:"dateClick",date:t.date};this._data&&this.selectDay({date:e.date}),this.$raiseEvent(e)},navigate:function(t,e){var s=aria.utils.Date;t&&t.preventDefault&&t.preventDefault();var a=this._calendarData.startDate,i=this._transformDate(a,e);null!=i&&(s.isSameDay(a,i)||s.isSameDay(this._calendarSettings.startDate,i)||(this.json.setValue(this._calendarSettings,"startDate",i),this.update()))},selectDay:function(t){var e=t.date;(!e||this._isSelectable(e))&&(this.json.setValue(this._calendarSettings,"value",e),this._ensureDateVisible(e),this.update())},_ensureDateVisible:function(t){var e=aria.utils.Date;if(t){var s=this._calendarData;(e.dayDifference(t,s.startDate)>0||0>e.dayDifference(t,s.endDate)||this._changedSettings.startDate)&&this.json.setValue(this._calendarSettings,"startDate",t)}},_getMonthKey:function(t){return[t.getMonth(),t.getFullYear()].join("-")},update:function(){var t=aria.utils.Date;if(0!==this._changedSettingsNbr){var e=this.json,s=this._changedSettings,a=this._calendarData,i=this._calendarSettings;if(s.minValue&&e.setValue(i,"minValue",t.removeTime(i.minValue)),s.maxValue&&e.setValue(i,"maxValue",t.removeTime(i.maxValue)),(s.value||s.minValue||s.maxValue)&&this._checkValue(),s.value&&1==this._changedSettingsNbr){var n=s.value,r=s.value.oldValue,o=i.value;if(r){var l=this.getDatePosition(r);l&&(l.day.isSelected=!1,n.oldValuePosition=l)}if(o){var h=this.getDatePosition(o);h&&(h.day.isSelected=!0,n.newValuePosition=h)}}else{(s.firstDayOfWeek||s.dayOfWeekLabelFormat)&&e.setValue(a,"daysOfWeek",this._createDaysOfWeek()),e.setValue(a,"today",new Date);var c,u,d,p=new Date(i.startDate);"W"==i.displayUnit?(p=t.getStartOfWeek(p,i.firstDayOfWeek),c=new Date(p.getFullYear(),p.getMonth(),1),c=t.getStartOfWeek(c,i.firstDayOfWeek),u=new Date(p.getTime()),u.setDate(u.getDate()+7*i.numberOfUnits-1),d=new Date(u.getTime()),d.setDate(32),d.setDate(1)):(p=new Date(p.getFullYear(),p.getMonth(),1),c=t.getStartOfWeek(p,i.firstDayOfWeek),u=new Date(p.getTime()),u.setMonth(u.getMonth()+i.numberOfUnits),u.setDate(u.getDate()-1),d=new Date(u.getTime()),d.setDate(d.getDate()+1));var g=[],f=[];this._createMonthsAndWeeks(c,d,g,f),e.setValue(a,"startDate",p),e.setValue(a,"endDate",u),e.setValue(a,"weeks",g),e.setValue(a,"months",f),e.setValue(a,"startMonthIndex",0),e.setValue(a,"endMonthIndex",f.length-1),e.setValue(a,"startWeekIndex",Math.floor(t.dayDifference(c,p)/7)),e.setValue(a,"endWeekIndex",Math.floor(t.dayDifference(c,u)/7)),this.$assert(128,a.endMonthIndex<f.length),this.$assert(129,a.endWeekIndex<g.length);var _=i.minValue,m=i.maxValue;e.setValue(a,"previousPageEnabled",!_||p>_),e.setValue(a,"nextPageEnabled",!m||m>u),this._realStartDate=c}var D=this._changedSettings,y=this._changedSettingsNbr;this._changedSettings={},this._changedSettingsNbr=0,this.$raiseEvent({name:"update",properties:D,propertiesNbr:y,propertyshowShortcuts:i.showShortcuts})}},_transformDate:function(t,e){var s;if(null!=e.increment)if(null==t&&(t=this._calendarSettings.startDate),s=new Date(t),"M"==e.incrementUnit){var a=s.getMonth();s.setMonth(a+e.increment),(24+a+e.increment)%12!=s.getMonth()&&s.setDate(0)}else"D"==e.incrementUnit?s.setDate(s.getDate()+e.increment):s.setDate(s.getDate()+7*e.increment);else if(e.refDate){var i=e.refDate;"minValue"==i?this._calendarSettings.minValue&&(s=this._calendarSettings.minValue):"maxValue"==i&&this._calendarSettings.maxValue&&(s=this._calendarSettings.maxValue)}else e.date&&(s=new Date(e.date));return s},_createDaysOfWeek:function(){for(var t=aria.utils.Date,e=[],s=this._calendarSettings.dayOfWeekLabelFormat,a=t.getStartOfWeek(new Date,this._calendarSettings.firstDayOfWeek),i=0;7>i;i++)e.push({label:t.format(a,s),day:a.getDay()}),a.setDate(a.getDate()+1);return e},_createMonthsAndWeeks:function(t,e,s,a){for(var i=new Date(t.getTime()),n=1==i.getDate()?i.getMonth():null;e>i;){var r=this._createWeek(i);if(s.push(r),i.getMonth()!=n){if(null!=n){var o=this._createMonth(s,s.length-1);a.push(o),a[o.monthKey]=o}n=i.getMonth()}}},_createWeek:function(t){for(var e,s=aria.utils.Date,a=0,i=[],n={days:i,indexInMonth:1+Math.floor((t.getDate()-2)/7),weekNumber:s.dayOfWeekNbrSinceStartOfYear(t)},r=0;7>r;r++){var o=this._createDay(t);i.push(o),e?0===a&&e!=o.monthKey&&(a=r):e=o.monthKey,1==t.getDate()&&(n.monthStart=o.monthKey,o.isFirstOfMonth=!0),t.setDate(t.getDate()+1),1==t.getDate()&&(n.monthEnd=o.monthKey,o.isLastOfMonth=!0)}return n.overlappingDays=a,0===a&&(n.month=e),n},_isSelectable:function(t){var e=this._calendarSettings,s=e.minValue,a=e.maxValue;return(!s||t>=s)&&(!a||a>=t)},_checkValue:function(){var t=this._calendarSettings,e=t.value,s=t.minValue,a=t.maxValue,i=e;null!=e&&(s&&s>e&&(i=s),a&&e>a&&(i=a),i!=e&&(s>a&&(i=null),this.json.setValue(t,"value",i)))},_createDay:function(t){var e=aria.utils.Date,s=this._calendarSettings,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=t.getDay(),n={jsDate:a,label:e.format(a,s.dateLabelFormat),monthKey:this._getMonthKey(t)};return(0===i||6===i)&&(n.isWeekend=!0),e.isSameDay(a,this._calendarData.today)&&(n.isToday=!0),e.isSameDay(a,s.value)&&(n.isSelected=!0),n.isSelectable=this._isSelectable(a),n},_createMonth:function(t,e){for(var s=aria.utils.Date,a=t[e],i=a.days[0].monthKey,n=[],r={monthKey:i,weeks:n},o=e;o>=0;o--){var l=t[o];if(n.unshift(l),l.monthStart==i)break}var h=n[0];this.$assert(260,h.monthStart==i);var c=h.days[h.overlappingDays].jsDate;return r.firstOfMonth=c,r.label=s.format(c,this._calendarSettings.monthLabelFormat),r.weeksInMonth=n.length,r.daysBeforeStartOfMonth=h.overlappingDays,r.daysAfterEndOfMonth=a.overlappingDays>0?7-a.overlappingDays:0,r.daysInMonth=7*n.length-r.daysBeforeStartOfMonth-r.daysAfterEndOfMonth,r.wholeWeeksInMonth=n.length-(h.overlappingDays>0?1:0)-(a.overlappingDays>0?1:0),r}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/calendar/CalendarTemplate.tpl
//*******************
Aria.classDefinition({$classpath:"atplugins.lightWidgets.calendar.CalendarTemplate",$extends:"aria.templates.Template",$constructor:function(){this.$Template.constructor.call(this),this.$CalendarTemplateScript.constructor.call(this)},$destructor:function(){this.$CalendarTemplateScript.$destructor.call(this),this.$Template.$destructor.call(this)},$dependencies:["aria.widgets.AriaLib","atplugins.lightWidgets.calendar.CalendarTemplateScript","aria.utils.Type","aria.utils.Date"],$resources:{res:"aria.resources.CalendarRes"},$prototype:{macro_main:function(){try{with(this)"M"==settings.displayUnit&&this.macro_renderCalendar()}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},macro_renderCalendar:function(){try{with(this){settings.label&&(this.__$write('\n<div class="',38),this.__$write(skin.baseCSS,38),this.__$write('label">',38),this.__$write(settings.label,38),this.__$write("</div>\n",38));for(var startIndex=calendar.startMonthIndex,endIndex=calendar.endMonthIndex,index=startIndex;endIndex>=index;index++)this.__$write('\n<span style="display: inline-block; vertical-align: top; margin: 2px;">\n',41),this.macro_renderMonth(calendar.months[index],index==startIndex,index==endIndex),this.__$write("\n</span>\n",43);settings.showShortcuts&&(this.__$write('\n<div style="text-align: center; margin: 1px;">\n<a title="',46),this.__$write(this.$modifier("dateformat",[calendar.today,settings.completeDateLabelFormat]),47),this.__$write('" tabIndex="-1" href="javascript:;" ',47),this.__$statementOnEvent("click",this.$normCallback({fn:"navigate",scope:data.controller,args:{date:calendar.today}}),47),this.__$write(">",47),this.__$write(res.today,47),this.__$write("</a>\n",47),this.__$beginSection(48,!1,{id:"selectedDay",macro:"selectedDay"}),this.__$endSection(),this.__$write("\n</div>\n",52))}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderCalendar",this["aria:currentLineNumber"]],_ex)}},macro_selectedDay:function(){try{with(this)settings.value&&(this.__$write('\n&nbsp;|&nbsp; <a title="',58),this.__$write(this.$modifier("dateformat",[settings.value,settings.completeDateLabelFormat]),58),this.__$write('" tabIndex="-1" href="javascript:;" ',58),this.__$statementOnEvent("click",this.$normCallback({fn:"navigate",scope:data.controller,args:{date:settings.value}}),58),this.__$write(">",58),this.__$write(res.selectedDate,58),this.__$write("</a>\n",58))}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["selectedDay",this["aria:currentLineNumber"]],_ex)}},macro_renderMonth:function(month,first,last){try{with(this){this.__$write('\n<table class="',63),this.__$write(skin.baseCSS,63),this.__$write('month" cellspacing="0" style="width: ',63),this.__$write(settings.showWeekNumbers?138:128,63),this.__$write('px;">\n<thead>\n<tr>\n<th colspan="8">\n<div class="',63),this.__$write(skin.baseCSS,67),this.__$write('monthTitle" style="position: relative;">\n',67),!first||!calendar.previousPageEnabled&&settings.restrainedNavigation||(this.__$write('\n<div class="previousMonth" style="position: absolute; left: 0px; top: -2px; cursor: pointer;" ',69),this.__$statementOnEvent("click",this.$normCallback({fn:"navigate",args:{increment:-1,incrementUnit:"M"},scope:data.controller}),69),this.__$write(">&nbsp;</div>\n",69)),!last||!calendar.nextPageEnabled&&settings.restrainedNavigation||(this.__$write('\n<div class="nextMonth" style="position: absolute; right: 0px; top: -2px; cursor: pointer;" ',72),this.__$statementOnEvent("click",this.$normCallback({fn:"navigate",args:{increment:1,incrementUnit:"M"},scope:data.controller}),72),this.__$write(">&nbsp;</div>\n",72)),this.__$write(month.label,74),this.__$write("\n</div>\n</th>\n</tr>\n<tr>\n",75),settings.showWeekNumbers&&(this.__$write('<th  class="',79),this.__$write(skin.baseCSS,79),this.__$write('weekNumber">&nbsp;</th>',79));var __v_1=calendar.daysOfWeek;void 0==calendar.daysOfWeek&&this.$logError(this.ITERABLE_UNDEFINED,["foreach",80]);for(var day_ct=0,__v_2=__v_1.length,day_index=0;__v_2>day_index;day_index++){var day=__v_1[day_index];day_ct++,this.__$write('\n<th class="',81),this.__$write(skin.baseCSS,81),this.__$write('weekDaysLabel">',81),this.__$write(day.label,81),this.__$write("</th>\n",81)}this.__$write("\n</tr>\n</thead>\n<tbody ",83),this.__$statementOnEvent("click",this.$normCallback(clickDay),85),this.__$write(" ",85),this.__$statementOnEvent("mouseover",this.$normCallback(mouseOverDay),85),this.__$write(" ",85),this.__$statementOnEvent("mouseout",this.$normCallback(mouseOutDay),85),this.__$write(" ",85),this.__$writeId("month_"+month.monthKey,85),this.__$write(">\n",85);var nbweeks=0,__v_3=month.weeks;void 0==month.weeks&&this.$logError(this.ITERABLE_UNDEFINED,["foreach",87]);for(var week_ct=0,__v_4=__v_3.length,week_index=0;__v_4>week_index;week_index++){var week=__v_3[week_index];week_ct++,nbweeks+=1,this.__$write("\n<tr>\n",89),settings.showWeekNumbers&&(this.__$write('<td class="',90),this.__$write(skin.baseCSS,90),this.__$write('weekNumber">',90),0==week.overlappingDays||week.monthEnd==month.monthKey?this.__$write(week.weekNumber,90):this.__$write("&nbsp;",90),this.__$write("</td>",90));var __v_5=week.days;void 0==week.days&&this.$logError(this.ITERABLE_UNDEFINED,["foreach",91]);for(var day_ct=0,__v_6=__v_5.length,day_index=0;__v_6>day_index;day_index++){var day=__v_5[day_index];day_ct++,this.macro_renderDay(day,month)}this.__$write("\n</tr>\n",94)}for(;5>=nbweeks;nbweeks++)this.__$write("\n<tr>\n",97),settings.showWeekNumbers&&(this.__$write('<td class="',98),this.__$write(skin.baseCSS,98),this.__$write('weekNumber" style="visibility: hidden;">&nbsp;</td>',98)),this.__$write('\n<td class="',99),this.__$write(skin.baseCSS,99),this.__$write('day" colspan="7" style="visibility: hidden;">&nbsp;</td>\n</tr>\n',99);this.__$write("\n</tbody>\n</table>\n",102)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderMonth",this["aria:currentLineNumber"]],_ex)}},macro_renderDay:function(day,month){try{with(this){var jsDate=day.jsDate;day.monthKey==month.monthKey?(this.__$write("\n<td ",109),this.__$write(day.isSelectable?'data-date="'+jsDate.getTime()+'"':"",109),this.__$write('\nclass="',110),this.__$write(getClassForDay(day),110),this.__$write('"\n>',110),this.__$write(day.label,111),this.__$write("</td>\n",111)):this.__$write("\n<td />\n",113)}}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["renderDay",this["aria:currentLineNumber"]],_ex)}},$init:function(t){t.__$macrolibs={},t.__$width={},t.__$height={},aria.core.TplClassLoader._importScriptPrototype(atplugins.lightWidgets.calendar.CalendarTemplateScript,t)},__$initTemplate:function(){try{with(this)this.calendar=data.dataModel.calendar,this.settings=data.dataModel.settings,this.skin=data.dataModel.skin}catch(_ex){return this.$logError(this.EXCEPTION_IN_VARINIT,[this.$classpath],_ex),!1}return!0}}});
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/calendar/CalendarTemplateScript.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.tplScriptDefinition({$classpath:e+"calendar.CalendarTemplateScript",$constructor:function(){this._controllerListener={fn:this._onControllerEvent,scope:this},this._listenerAdded=!1},$destructor:function(){this._listenerAdded&&this.data.controller.$unregisterListeners(this),this._controllerListener=null},$prototype:{$dataReady:function(){this.data.controller.$addListeners({"*":this._controllerListener,scope:this}),this._listenerAdded=!0},_onControllerEvent:function(t){if("update"==t.name){var e=t.properties.value;1==t.propertiesNbr&&e?(this.updateClass(e.oldValuePosition),this.updateClass(e.newValuePosition),t.propertyshowShortcuts&&this.$refresh({outputSection:"selectedDay"})):this.$refresh()}},updateClass:function(t){if(null!=t&&null!=t.month){var e=this.$getChild("month_"+t.month.monthKey,t.weekInMonthIndex),s=e.getChild((this.settings.showWeekNumbers?1:0)+t.dayInWeekIndex);s.classList.setClassName(this.getClassForDay(t.day)),s.$dispose(),e.$dispose()}},clickDay:function(t){var e=t.target.getData("date");if(e){var s=new Date(parseInt(e,10));this.data.controller.dateClick({date:s})}},getClassForDay:function(t){var e=[],s=this.skin.baseCSS;return e.push(s+"day"),e.push(s+"mouseOut"),t.isWeekend&&t.isSelectable&&e.push(s+"weekEnd"),t.isSelected&&e.push(s+"selected"),t.isToday&&e.push(s+"today"),e.push(t.isSelectable?s+"selectable":s+"unselectable"),e.join(" ")},mouseOverDay:function(t){var e=t.target.getData("date");e&&t.target.classList.setClassName(t.target.classList.getClassName().replace(this.skin.baseCSS+"mouseOut",this.skin.baseCSS+"mouseOver"))},mouseOutDay:function(t){var e=t.target.getData("date");e&&t.target.classList.setClassName(t.target.classList.getClassName().replace(this.skin.baseCSS+"mouseOver",this.skin.baseCSS+"mouseOut"))}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/datefield/DateField.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.classDefinition({$classpath:e+"datefield.DateField",$extends:e+"textinput.TextInputWithOnChange",$dependencies:["aria.utils.Date",e+"datefield.DateFieldCfgBeans"],$constructor:function(t,s,i){this.$cfgBean=e+"datefield.DateFieldCfgBeans.Properties",this._dateUtil=aria.utils.Date,this.$TextInputWithOnChange.constructor.call(this,t,s,i)},$destructor:function(){this._dateUtil=null,this.$TextInputWithOnChange.$destructor.call(this)},$prototype:{_transform:function(t,e,s){var i=null;return"fromWidget"==s?(i=this._dateUtil.interpret(e),i&&(this._isValidDate(i)?this.onbind("value",this._dateUtil.format(i,this._cfg.pattern),e):i=null),this.$TextInputWithOnChange._transform.call(this,t,i,s)):e&&this._isValidDate(e)?(i=this.$TextInputWithOnChange._transform.call(this,t,e,s),this._dateUtil.format(e,this._cfg.pattern)):""},_isValidDate:function(t){var e=this._cfg;return e.minValue&&0>this._dateUtil.compare(t,e.minValue)?!1:e.maxValue&&this._dateUtil.compare(t,e.maxValue)>0?!1:!0},applyTextToData:function(){var t=this._bindingListeners.value,e=this._hasPlaceholder?"":this._domElt.value,s=this._transform(t.transform,e,"fromWidget");aria.utils.Json.setValue(t.inside,t.to,s,t.cb)}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/datefield/DateFieldCfgBeans.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.beanDefinitions({$package:e+"datefield.DateFieldCfgBeans",$namespaces:{json:"aria.core.JsonTypes",base:"aria.html.beans.TextInputCfg"},$beans:{Properties:{$type:"base:Properties",$properties:{tagName:{$type:"base:Properties.$properties.tagName",$default:"input",$mandatory:!1},pattern:{$type:"json:String",$default:"d/M/y"},minValue:{$type:"json:Date"},maxValue:{$type:"json:Date"}}}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/datepicker/DatePicker.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".",s=Aria.nspace(t,!0);Aria.classDefinition({$classpath:e+"datepicker.DatePicker",$extends:"aria.html.Element",$dependencies:[e+"LazyLoader",e+"datepicker.DatePickerCfgBeans",e+"datefield.DateField","aria.utils.Json","aria.DomEvent"],$statics:{INVALID_USAGE:"Widget %1 can only be used as a %2."},$constructor:function(t,i,a){this._jsonUtil=aria.utils.Json,this.data={value:t.value||null,calendarValue:null,startDate:null},this._internalDataModelChange={fn:this._updateExternalDataModel,scope:this},this._jsonUtil.addListener(this.data,"value",this._internalDataModelChange),this.$cfgBean=e+"datepicker.DatePickerCfgBeans.Properties",t.on=t.on||{},this._registerListeners(t),this.$Element.constructor.call(this,t,i,a),this._iconDomElt=null,this._dateField=new s.datefield.DateField(this._getDateFieldConfig(),i,a),s.LazyLoader.register(this.$classpath,{classes:[e+"datepicker.DatePickerDropDown"],templates:[t.calendar.template]})},$destructor:function(){this._dropdown&&this._dropdown.close(),this._dateField.$dispose(),this._jsonUtil.removeListener(this.data,"value",this._internalDataModelChange),this._internalDataModelChange=null,this.data=null,this._onDropDownCloseCallback=null,this._iconDomElt=null,this.$Element.$destructor.call(this)},$prototype:{writeMarkup:function(t){this.$Element.writeMarkupBegin.call(this,t),this._dateField.writeMarkup(t),this._writeIconMarkup(t),this.$Element.writeMarkupEnd.call(this,t)},writeMarkupBegin:function(){this.$logError(this.INVALID_USAGE,[this.$class,"container"])},writeMarkupEnd:Aria.empty,initWidget:function(){this._dateField.initWidget(),this.$Element.initWidget.call(this),this._iconDomElt=this._domElt.children[1],this._cfg.lazy||s.LazyLoader.load(this.$classpath)},onbind:function(t,e){"value"===t&&this._jsonUtil.setValue(this.data,"value",e,this._internalDataModelChange)},setWidgetProperty:function(t,e){"value"===t&&this._jsonUtil.setValue(this.data,"value",e)},_registerListeners:function(t){var e=t.on;this._chainListener(e,"click",{fn:this._onclick,scope:this})},_onclick:function(t){"icon"==t.target.getData("role")&&(this._triggerDropDown(),this._dateField.focus())},_updateExternalDataModel:function(t){var e=this._bindingListeners.value;if(e){var s=this._transform(e.transform,t.newValue,"fromWidget");aria.utils.Json.setValue(e.inside,e.to,s,e.cb)}},_onDropDownClose:function(){var t=null;this._dropdown&&(t=this._dropdown.closeEvent,this._dropdown.$dispose(),this._dropdown=null),t&&t==aria.DomEvent.KC_TAB||this._dateField.focus(),t&&t!=aria.DomEvent.KC_ESCAPE&&(this._jsonUtil.setValue(this.data,"value",this.data.calendarValue),this._dateField.callChangeListener())},_writeIconMarkup:function(t){var e=this._cfg.sclass||"std";t.write('<span data-role="icon" class="'+e+'-dropdown-icon" style="cursor: pointer;">&nbsp;</span>')},_triggerDropDown:function(){if(s.LazyLoader.isLoaded(this.$classpath)){this._dropdown||(this._dropdown=new s.datepicker.DatePickerDropDown(this._getDropDownConfig()));var t=this._dropdown;t.isOpen()?t.close():(this._jsonUtil.setValue(this.data,"calendarValue",this.data.value),t.open())}else s.LazyLoader.load(this.$classpath,{fn:this._triggerDropDown,scope:this})},_getDateFieldConfig:function(){var t=this._cfg,e=this._jsonUtil.copy(t.dateField);t.minValue&&(e.minValue=t.minValue),t.maxValue&&(e.maxValue=t.maxValue),e.bind={value:{to:"value",inside:this.data}},e.on=e.on||{},this._chainListener(e.on,"keydown",{fn:this._onDateFieldKeydown,scope:this});var s=this._cfg.sclass||"std";return e.attributes=e.attributes||{},e.attributes.classList=e.attributes.classList?e.attributes.classList.concat(s):[s],e.attributes.autocomplete="off",e},_getDropDownConfig:function(){var t={calendar:this._getCalendarCfg(),domReference:this._domElt,context:this._context,lineNumber:this._lineNumber,ignoreClicksOn:[this._iconDomElt],onAfterClose:{fn:this._onDropDownClose,scope:this}};return t},_getCalendarCfg:function(){var t=this._cfg,e=this._jsonUtil.copy(t.calendar);return t.minValue&&(e.minValue=t.minValue),t.maxValue&&(e.maxValue=t.maxValue),e.bind={value:{to:"calendarValue",inside:this.data}},e.startDate=this.data.value,e.sclass=this._cfg.sclass||e.sclass||"std",e},_onDateFieldKeydown:function(t){var e=aria.DomEvent,s=this._dropdown;s&&s.isOpen()?s.processKeyEvent(t):t.keyCode==e.KC_ARROW_DOWN&&(this._dateField.applyTextToData(),this._triggerDropDown(),t.preventDefault())},getId:function(){return this._cfg.id}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/datepicker/DatePickerCfgBeans.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".";Aria.nspace(t,!0),Aria.beanDefinitions({$package:e+"datepicker.DatePickerCfgBeans",$namespaces:{json:"aria.core.JsonTypes",base:"aria.html.beans.ElementCfg",calendar:e+"calendar.CalendarCfgBeans",datefield:e+"datefield.DateFieldCfgBeans",textinput:"aria.html.beans.TextInputCfg"},$beans:{Properties:{$type:"base:Properties",$properties:{tagName:{$type:"base:Properties.$properties.tagName",$default:"span",$mandatory:!1},minValue:{$type:"json:Date"},maxValue:{$type:"json:Date"},lazy:{$type:"json:Boolean",$default:!1},dateField:{$type:"datefield:Properties",$restricted:!1,$properties:{minValue:{$type:"datefield:Properties.$properties.minValue"},maxValue:{$type:"datefield:Properties.$properties.maxValue"},bind:{$type:"textinput:Properties.$properties.bind"}},$default:{}},calendar:{$type:"calendar:Properties",$restricted:!1,$properties:{bind:{$type:"calendar:Properties.$properties.bind"}},$default:{}},sclass:{$type:"json:String",$default:"std"}}}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/datepicker/DatePickerDropDown.js
//*******************
(function(){var t="atplugins.lightWidgets",e=t+".",a=Aria.nspace(t,!0);Aria.classDefinition({$classpath:e+"datepicker.DatePickerDropDown",$extends:e+"DropDown",$dependencies:[e+"calendar.Calendar","aria.DomEvent","aria.utils.Type","aria.core.Browser"],$constructor:function(){this.$DropDown.constructor.apply(this,arguments),this._calendar=null,this.closeEvent=null,this._offset=aria.core.Browser.isIE7?{top:5,bottom:-10,left:0,right:0}:{top:5,bottom:5,left:0,right:0}},$destructor:function(){this._calendar=null,this.$DropDown.$destructor.apply(this,arguments)},$prototype:{_contentWriter:function(t){var e=this._cfg.calendar;this._addCalendarListeners(e);var s=e.sclass;t.write('<span style="display: inline-block; overflow: visible" class="'+s+'dpCalendarContainer">');var i=new a.calendar.Calendar(e,this._cfg.context,this._cfg.lineNumber);t.registerBehavior(i),i.writeMarkup(t),t.write("</span>"),this._calendar=i},_addCalendarListeners:function(t){t.on=t.on||{},t.on.keydown=t.on.keydown?aria.utils.Type.isArray(t.on.keydown)?t.on.keydown:[t.on.keydown]:[],t.on.keydown.push({fn:this._onCalendarKeydown,scope:this}),t.on.click=t.on.click?aria.utils.Type.isArray(t.on.click)?t.on.click:[t.on.click]:[],t.on.click.push({fn:this._onCalendarClick,scope:this})},_onCalendarKeydown:function(t){var e=t.keyCode,a=aria.DomEvent,s=!0;(e==a.KC_ENTER||e==a.KC_SPACE||e==a.KC_TAB||e==a.KC_ESCAPE)&&(this.closeEvent=e,this.close(),this.closeEvent=null,e==a.KC_TAB&&(s=!1)),s&&t.preventDefault(!0)},_onCalendarClick:function(t){t.date&&(this.closeEvent="click",this.close(),this.closeEvent=null)},processKeyEvent:function(t){this._calendar.sendKey(t.charCode,t.keyCode),this._onCalendarKeydown(t)}}})})();
//*******************
//LOGICAL-PATH:atplugins/lightWidgets/textinput/TextInputWithOnChange.js
//*******************
(function(){function t(){this._storedValue=this._hasPlaceholder?"":this._domElt.value}function e(){var t=this._hasPlaceholder?"":this._domElt.value;this._storedValue!=t&&this.$callback(this._changeListener,t)}var s="atplugins.lightWidgets",a=s+".";Aria.nspace(s,!0),Aria.classDefinition({$classpath:a+"textinput.TextInputWithOnChange",$extends:"aria.html.TextInput",$dependencies:["aria.utils.Date"],$constructor:function(s,a,i){this._storedValue=null,s.on=s.on||{};var n=s.on.change;n&&(delete s.on.change,this._changeListener=this.$normCallback.call(a._tpl,n),this._chainListener(s.on,"focus",{fn:t,scope:this}),this._chainListener(s.on,"blur",{fn:e,scope:this},!0)),this.$TextInput.constructor.call(this,s,a,i)},$destructor:function(){this._changeListener=null,this.$TextInput.$destructor.call(this)},$prototype:{getDom:function(){return this._domElt},callChangeListener:function(){var t=this._hasPlaceholder?"":this._domElt.value;this._storedValue!=t&&this.$callback(this._changeListener,t),this._storedValue=t}}})})();